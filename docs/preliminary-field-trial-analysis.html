<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Preliminary field trial analysis | Genomic Prediction and Selection Manual</title>
<meta name="author" content="Marnin Wolfe">
<meta name="description" content="Context and Purpose: Upstream: Section 6 - quality control steps for genotypic data Downstream: Genomic prediction and related analyses. Inputs: Expected outputs:  7.1 One-stage or multi-stage? We...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 7 Preliminary field trial analysis | Genomic Prediction and Selection Manual">
<meta property="og:type" content="book">
<meta property="og:url" content="https://wolfemd.github.io/GenomicSelectionManual/preliminary-field-trial-analysis.html">
<meta property="og:description" content="Context and Purpose: Upstream: Section 6 - quality control steps for genotypic data Downstream: Genomic prediction and related analyses. Inputs: Expected outputs:  7.1 One-stage or multi-stage? We...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Preliminary field trial analysis | Genomic Prediction and Selection Manual">
<meta name="twitter:description" content="Context and Purpose: Upstream: Section 6 - quality control steps for genotypic data Downstream: Genomic prediction and related analyses. Inputs: Expected outputs:  7.1 One-stage or multi-stage? We...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genomic Prediction and Selection Manual</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled"><li><a class="" href="index.html"><span class="header-section-number">Chapter 7</span> Preliminary field trial analysis</a></li></ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/wolfemd/GenomicSelectionManual">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="preliminary-field-trial-analysis" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Preliminary field trial analysis<a class="anchor" aria-label="anchor" href="#preliminary-field-trial-analysis"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p><strong>Context and Purpose:</strong></p></li>
<li><p><strong>Upstream:</strong> Section <a href="prepare-genotypic-data.html#prepare-genotypic-data">6</a> - quality control steps for genotypic data</p></li>
<li><p><strong>Downstream:</strong> Genomic prediction and related analyses.</p></li>
<li><p><strong>Inputs:</strong></p></li>
<li><p><strong>Expected outputs:</strong></p></li>
</ul>
<div id="one-stage-or-multi-stage" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> One-stage or multi-stage?<a class="anchor" aria-label="anchor" href="#one-stage-or-multi-stage"><i class="fas fa-link"></i></a>
</h2>
<p>We often have very large, multi-year, multi-location, multi-trial-type (<strong>MET</strong>) datasets we use to train genomic prediction models. The number of plots can be in the range of 10- or even 100,000 plots with many thousands of unique genotypes observed in unbalanced fashion across heterogenous experimental designs. All that to say, the computational burden and level of expertise required to execute genomic prediction analyses directly on these data is very great.</p>
<p>For the sake of semi-automation and computational efficiency, the standard genomic prediction pipeline I have implemented for NextGen Cassava, which I demonstrate below, has two stages:</p>
<p><strong>Stage 1. Get BLUPs</strong></p>
<ul>
<li>
<p>Conduct preliminary analysis of the trial data <em>without</em> genomic relatedeness / marker-information.</p>
<p>Identify the best-fitting model for the data and potentially curate the raw data, removing outliers.</p>
</li>
<li><p>Fit mixed-model to <strong>MET</strong> data. Extract <strong><code>BLUPs</code></strong>, <strong><code>PEVs</code></strong> and variance components (<strong><code>VarComps</code></strong>). Compute de-regressed BLUPs (<strong><code>drgBLUPs</code></strong>) and weights (<strong><code>WTS</code></strong>) for “Stage 2.”</p></li>
</ul>
<p><strong>Stage 2. Cross-validation and genomic prediction</strong></p>
<p>Conduct weighted cross-validation and genomic prediction analyses using <strong><code>de-regressed BLUPs</code></strong> (alternative <strong><code>BLUEs</code></strong>) as the response variable and the weights from Stage 1. This effectively reduces the number of “observations” in the analysis to the number of unique genotypes (i.e. clones, inbred lines, etc.), leading to lower computational burden.</p>
<p><strong>Note of advice for single-stage analyses:</strong> I strongly recommend conducting preliminary analysis of the trial data <em>without</em> genomic relatedeness / marker-information. Ensure the model will converge, residuals look acceptable and otherwise assess the best fitting model <em>before</em> commiting to lengthy computationally intensive analyses. :)</p>
</div>
<div id="set-up-training-datasets" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Set-up training datasets<a class="anchor" aria-label="anchor" href="#set-up-training-datasets"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phenos</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"output"</span>,<span class="st">"phenotypes_cleaned.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The pipeline version of this analysis will use the <code>TRUE/FALSE</code> values of <strong><code>CompleteBlocks</code></strong> and <strong><code>IncompleteBlocks</code></strong> ([Preliminary analysis of trial data][#detect_designs]).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phenos</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> 
     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">CompleteBlocks</span>,<span class="va">IncompleteBlocks</span>,<span class="va">locationName</span><span class="op">)</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> 
     <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span><span class="va">locationName</span>,<span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 × 4</span>
<span class="co">#&gt;   CompleteBlocks IncompleteBlocks Ibadan Ubiaja</span>
<span class="co">#&gt;   &lt;lgl&gt;          &lt;lgl&gt;             &lt;int&gt;  &lt;int&gt;</span>
<span class="co">#&gt; 1 FALSE          TRUE                777     NA</span>
<span class="co">#&gt; 2 TRUE           FALSE                NA    125</span>
<span class="co">#&gt; 3 TRUE           TRUE                407    414</span></code></pre></div>
<p>Convert the data to “long format” . Remove missing values. “Nest” the data by Trait.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">traits</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DM"</span>,<span class="st">"MCMDS"</span>,<span class="st">"logFYLD"</span>,<span class="st">"logDYLD"</span><span class="op">)</span>
<span class="va">phenos</span><span class="op">&lt;-</span><span class="va">phenos</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> 
     <span class="co"># Convert the data to "long format" </span>
     <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">traits</span><span class="op">)</span>, 
                  names_to <span class="op">=</span> <span class="st">"Trait"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span>
     <span class="co"># Remove missing values</span>
     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span>
     <span class="co"># Nest the MultiEnvironmentTrial data by trait</span>
     <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>METdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Trait</span><span class="op">)</span><span class="op">)</span>
<span class="va">phenos</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> 
     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>N_plots<span class="op">=</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">METdata</span>,<span class="va">nrow</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 3</span>
<span class="co">#&gt;   Trait   METdata               N_plots</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;list&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 DM      &lt;tibble [1,448 × 35]&gt;    1448</span>
<span class="co">#&gt; 2 MCMDS   &lt;tibble [1,436 × 35]&gt;    1436</span>
<span class="co">#&gt; 3 logFYLD &lt;tibble [1,590 × 35]&gt;    1590</span>
<span class="co">#&gt; 4 logDYLD &lt;tibble [1,443 × 35]&gt;    1443</span></code></pre></div>
<p>Where previously there was one row per plot and a large number of columns, now things are simple and tidy.</p>
<p>One row per trait. The actual plot-basis data are now contained within <strong>METdata</strong>, a list-type column, each element containing a <code>tibble</code>.</p>
<p>To demonstrate, check the contents of row 1 of the <strong>METdata</strong> column:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phenos</span><span class="op">$</span><span class="va">METdata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> <span class="va">head</span>
<span class="co">#&gt; # A tibble: 6 × 35</span>
<span class="co">#&gt;   studyYear programName locationName studyName   studyDesign</span>
<span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      </span>
<span class="co">#&gt; 1      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; 2      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; 3      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; 4      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; 5      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; 6      2019 IITA        Ubiaja       19.GS.C1.C… Alpha      </span>
<span class="co">#&gt; # … with 30 more variables: plotWidth &lt;int&gt;,</span>
<span class="co">#&gt; #   plotLength &lt;dbl&gt;, fieldSize &lt;dbl&gt;, plantingDate &lt;chr&gt;,</span>
<span class="co">#&gt; #   harvestDate &lt;chr&gt;, germplasmName &lt;chr&gt;,</span>
<span class="co">#&gt; #   observationUnitDbId &lt;int&gt;, replicate &lt;int&gt;,</span>
<span class="co">#&gt; #   blockNumber &lt;int&gt;, plotNumber &lt;int&gt;, rowNumber &lt;int&gt;,</span>
<span class="co">#&gt; #   colNumber &lt;int&gt;, entryType &lt;chr&gt;, trialType &lt;chr&gt;,</span>
<span class="co">#&gt; #   numberBlocks &lt;int&gt;, numberReps &lt;int&gt;, …</span></code></pre></div>
</div>
<div id="compare-models" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Compare models<a class="anchor" aria-label="anchor" href="#compare-models"><i class="fas fa-link"></i></a>
</h2>
<p>There is a “standard” model I have deployed reliably on Cassava MET data for the GS pipeline.</p>
<p>For the sake of demonstration, below I pick out one trait, and fit 3 models to it.</p>
<p>In the past, I have used both <code>lmer()</code> (<code>lme4</code> package) and <code>asreml()</code> (asreml R package) for this sort of analysis. <code>lmer()</code> is limited to homogenous error variance structures and only certain design models / variance structures. <code>asreml()</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sommer</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Matrix'</span>
<span class="co">#&gt; The following objects are masked from 'package:tidyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand, pack, unpack</span>
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'MASS'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     select</span>
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; Loading required package: crayon</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'crayon'</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     %+%</span>
<span class="va">METdata</span><span class="op">&lt;-</span><span class="va">phenos</span><span class="op">$</span><span class="va">METdata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://gt.rstudio.com/reference/pipe.html">%&gt;%</a></span> 
     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>CompleteBlocks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">CompleteBlocks</span><span class="op">)</span>,
            IncompleteBlocks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IncompleteBlocks</span><span class="op">)</span><span class="op">)</span>
<span class="va">m1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/mmer.html">mmer</a></span><span class="op">(</span><span class="va">Value</span><span class="op">~</span><span class="va">yearInLoc</span>,
         random<span class="op">=</span><span class="op">~</span><span class="va">germplasmName</span> <span class="op">+</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/sommer/man/vs.html">vs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/at.html">at</a></span><span class="op">(</span><span class="va">CompleteBlocks</span>,<span class="st">"TRUE"</span><span class="op">)</span>,<span class="va">repInTrial</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/sommer/man/vs.html">vs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/at.html">at</a></span><span class="op">(</span><span class="va">IncompleteBlocks</span>,<span class="st">"TRUE"</span><span class="op">)</span>,<span class="va">blockInRep</span><span class="op">)</span>,
         rcov<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/vs.html">vs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/ds.html">ds</a></span><span class="op">(</span><span class="va">studyName</span><span class="op">)</span>,<span class="va">units</span><span class="op">)</span>,
         data<span class="op">=</span><span class="va">METdata</span>, 
         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt;                  Multivariate Linear Mixed Model fit by REML                 </span>
<span class="co">#&gt; ******************************  sommer 4.1  ****************************** </span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt;         logLik     AIC      BIC Method Converge</span>
<span class="co">#&gt; Value -324.346 652.692 663.2478     NR     TRUE</span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt; Variance-Covariance components:</span>
<span class="co">#&gt;                                            VarComp</span>
<span class="co">#&gt; germplasmName.Value-Value                    5.220</span>
<span class="co">#&gt; TRUE:repInTrial.Value-Value                 11.186</span>
<span class="co">#&gt; TRUE:blockInRep.Value-Value                  1.330</span>
<span class="co">#&gt; 19.GS.C1.C2.C3.AYT.42.UB:units.Value-Value   8.353</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.IB:units.Value-Value    8.322</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.UB:units.Value-Value    4.133</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.IB:units.Value-Value    4.376</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.UB:units.Value-Value    5.441</span>
<span class="co">#&gt; 19.GS.C4B.PYT.135.UB:units.Value-Value      11.149</span>
<span class="co">#&gt; 19.GS.C4B.PYT.140.IB:units.Value-Value       3.918</span>
<span class="co">#&gt; 19.GS.C4C.CE.822.IB:units.Value-Value        6.478</span>
<span class="co">#&gt;                                            VarCompSE Zratio</span>
<span class="co">#&gt; germplasmName.Value-Value                     0.5807  8.989</span>
<span class="co">#&gt; TRUE:repInTrial.Value-Value                   4.5829  2.441</span>
<span class="co">#&gt; TRUE:blockInRep.Value-Value                   0.2954  4.503</span>
<span class="co">#&gt; 19.GS.C1.C2.C3.AYT.42.UB:units.Value-Value    1.6652  5.016</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.IB:units.Value-Value     1.6767  4.963</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.UB:units.Value-Value     0.9170  4.507</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.IB:units.Value-Value     0.9845  4.445</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.UB:units.Value-Value     1.1190  4.862</span>
<span class="co">#&gt; 19.GS.C4B.PYT.135.UB:units.Value-Value        1.3080  8.524</span>
<span class="co">#&gt; 19.GS.C4B.PYT.140.IB:units.Value-Value        0.4906  7.987</span>
<span class="co">#&gt; 19.GS.C4C.CE.822.IB:units.Value-Value         0.7080  9.149</span>
<span class="co">#&gt;                                            Constraint</span>
<span class="co">#&gt; germplasmName.Value-Value                    Positive</span>
<span class="co">#&gt; TRUE:repInTrial.Value-Value                  Positive</span>
<span class="co">#&gt; TRUE:blockInRep.Value-Value                  Positive</span>
<span class="co">#&gt; 19.GS.C1.C2.C3.AYT.42.UB:units.Value-Value   Positive</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.IB:units.Value-Value    Positive</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setA.UB:units.Value-Value    Positive</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.IB:units.Value-Value    Positive</span>
<span class="co">#&gt; 19.GS.C2.UYT.36.setB.UB:units.Value-Value    Positive</span>
<span class="co">#&gt; 19.GS.C4B.PYT.135.UB:units.Value-Value       Positive</span>
<span class="co">#&gt; 19.GS.C4B.PYT.140.IB:units.Value-Value       Positive</span>
<span class="co">#&gt; 19.GS.C4C.CE.822.IB:units.Value-Value        Positive</span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt; Fixed effects:</span>
<span class="co">#&gt;   Trait                    Effect Estimate Std.Error</span>
<span class="co">#&gt; 1 Value               (Intercept)   38.147    0.2314</span>
<span class="co">#&gt; 2 Value yearInLocIITA_Ubiaja_2019   -5.293    1.2302</span>
<span class="co">#&gt;   t.value</span>
<span class="co">#&gt; 1 164.880</span>
<span class="co">#&gt; 2  -4.302</span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt; Groups and observations:</span>
<span class="co">#&gt;                 Value</span>
<span class="co">#&gt; germplasmName     811</span>
<span class="co">#&gt; TRUE:repInTrial    15</span>
<span class="co">#&gt; TRUE:blockInRep   126</span>
<span class="co">#&gt; ============================================================================</span>
<span class="co">#&gt; Use the '$' sign to access results and parameters</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/mmer.html">mmer</a></span><span class="op">(</span><span class="va">Value</span><span class="op">~</span><span class="va">yearInLoc</span>,
         random<span class="op">=</span><span class="op">~</span><span class="va">germplasmName</span> <span class="op">+</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/sommer/man/vs.html">vs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/at.html">at</a></span><span class="op">(</span><span class="va">CompleteBlocks</span>,<span class="st">"TRUE"</span><span class="op">)</span>,<span class="va">repInTrial</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://rdrr.io/pkg/sommer/man/vs.html">vs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/at.html">at</a></span><span class="op">(</span><span class="va">IncompleteBlocks</span>,<span class="st">"TRUE"</span><span class="op">)</span>,<span class="va">blockInRep</span><span class="op">)</span>,
         data<span class="op">=</span><span class="va">METdata</span>, 
         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">m3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/sommer/man/mmer.html">mmer</a></span><span class="op">(</span><span class="va">Value</span><span class="op">~</span><span class="va">yearInLoc</span>,
         random<span class="op">=</span><span class="op">~</span><span class="va">germplasmName</span> <span class="op">+</span> <span class="va">repInTrial</span> <span class="op">+</span> <span class="va">blockInRep</span>,
         data<span class="op">=</span><span class="va">METdata</span>, 
         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">m1</span>,<span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test for mixed models</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik    Chisq ChiDf</span>
<span class="co">#&gt; mod1 17 652.6920 663.2478 -324.3460               </span>
<span class="co">#&gt; mod2 10 701.9414 712.4973 -348.9707 49.24947     7</span>
<span class="co">#&gt;                      PrChisq</span>
<span class="co">#&gt; mod1                        </span>
<span class="co">#&gt; mod2 2.0273987089018e-08 ***</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik    Chisq ChiDf</span>
<span class="co">#&gt; mod1 17 652.6920 663.2478 -324.3460               </span>
<span class="co">#&gt; mod2 10 701.9414 712.4973 -348.9707 49.24947     7</span>
<span class="co">#&gt;                      PrChisq</span>
<span class="co">#&gt; mod1                        </span>
<span class="co">#&gt; mod2 2.0273987089018e-08 ***</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">m1</span>,<span class="va">m3</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test for mixed models</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik    Chisq ChiDf</span>
<span class="co">#&gt; mod1 17 652.6920 663.2478 -324.3460               </span>
<span class="co">#&gt; mod2 10 695.2303 705.7862 -345.6152 42.53834     7</span>
<span class="co">#&gt;                       PrChisq</span>
<span class="co">#&gt; mod1                         </span>
<span class="co">#&gt; mod2 4.09508831534527e-07 ***</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik    Chisq ChiDf</span>
<span class="co">#&gt; mod1 17 652.6920 663.2478 -324.3460               </span>
<span class="co">#&gt; mod2 10 695.2303 705.7862 -345.6152 42.53834     7</span>
<span class="co">#&gt;                       PrChisq</span>
<span class="co">#&gt; mod1                         </span>
<span class="co">#&gt; mod2 4.09508831534527e-07 ***</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">m2</span>,<span class="va">m3</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test for mixed models</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik   Chisq ChiDf PrChisq</span>
<span class="co">#&gt; mod1 10 701.9414 712.4973 -348.9707                      </span>
<span class="co">#&gt; mod2 10 695.2303 705.7862 -345.6152 6.71113     0   0 ***</span>
<span class="co">#&gt; ==============================================================</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt;      Df      AIC      BIC     loLik   Chisq ChiDf PrChisq</span>
<span class="co">#&gt; mod1 10 701.9414 712.4973 -348.9707                      </span>
<span class="co">#&gt; mod2 10 695.2303 705.7862 -345.6152 6.71113     0   0 ***</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="empty"></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genomic Prediction and Selection Manual</strong>" was written by Marnin Wolfe. It was last built on 2022-01-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
